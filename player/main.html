<!DOCTYPE html>
<html>
<head>
  <title>Main Active Desktop Page</title>
  <style>
    body { margin:0; font-family:system-ui,sans-serif; background:#111; color:#eee; }
    .controls { background:#1a1a1a; padding:12px; text-align:center; position:sticky; top:0; z-index:10; }
    .controls h1 { margin:0 0 8px; }
    .controls .row { display:flex; flex-wrap:wrap; gap:8px; justify-content:center; }
    button { background:#222; color:#eee; border:1px solid #444; padding:8px 14px; border-radius:6px; cursor:pointer; }
    button:hover { background:#2b2b2b; }
    .grid { display:grid; grid-template-columns:repeat(4,1fr); gap:10px; padding:10px; height:60vh; }
    iframe { width:100%; height:100%; border:none; border-radius:8px; background:#000; }
    @media(max-width:768px){ .grid{grid-template-columns:repeat(2,1fr);height:auto;} iframe{height:220px;} }
    .activity { background:#1a1a1a; border-top:1px solid #333; padding:10px; font-size:13px; height:20vh; overflow-y:auto; }
    .stats { background:#222; padding:8px; font-size:12px; margin-top:6px; border-radius:6px; }
    body.light { background:#f9f9f9; color:#222; }
    body.light .controls { background:#eaeaea; }
    body.light button { background:#fff; color:#222; border-color:#ccc; }
    body.light button:hover { background:#ddd; }
    body.light .activity { background:#eaeaea; }
    body.light .stats { background:#ddd; }
  </style>
</head>
<body>
  <div class="controls">
    <h1>Main Active Desktop Page</h1>
    <div class="row">
      <button onclick="playAll()">â–¶ Play All</button>
      <button onclick="pauseAll()">â¸ Pause All</button>
      <button onclick="nextAll()">â­ Next All</button>
      <button onclick="shuffleAll()">ğŸ² Shuffle All</button>
      <button onclick="restartAll()">ğŸ” Restart All</button>
      <button onclick="stopAll()">â¹ Stop All</button>
      <button onclick="toggleMuteAll()">ğŸ”‡ Mute/Unmute All</button>
      <button onclick="randomizeVolumeAll()">ğŸ”Š Volume Randomize All</button>
      <button onclick="normalizeVolumeAll()">ğŸš Volume Normalize All</button>
      <button onclick="toggleTheme()">ğŸŒ“ Dark/Light Mode</button>
    </div>
  </div>

  <div class="grid">
    <div id="player1"></div><div id="player2"></div><div id="player3"></div><div id="player4"></div>
    <div id="player5"></div><div id="player6"></div><div id="player7"></div><div id="player8"></div>
  </div>

  <div class="activity" id="activityPanel"></div>
  <div class="stats" id="statsPanel"></div>

  <script src="https://www.youtube.com/iframe_api"></script>
  <script>
    let players=[],videoList=[],isMutedAll=true;
    const stats={autoNext:0,manualNext:0,shuffle:0,restart:0,pauses:0,volumeChanges:0};

    // Config
    const START_DELAY_MIN_S=5, START_DELAY_MAX_S=180;
    const INIT_SEEK_MAX_S=60;
    const UNMUTE_VOL_MIN=10, UNMUTE_VOL_MAX=30;
    const NORMALIZE_VOLUME_TARGET=20;
    const PAUSE_SMALL=[2000,5000], PAUSE_LARGE=[15000,30000];
    const MID_SEEK_INTERVAL_MIN=[5,9], MID_SEEK_WINDOW_S=[30,120];

    const ts=()=>new Date().toLocaleTimeString();
    function log(msg){console.log(msg);
      const panel=document.getElementById("activityPanel");
      const div=document.createElement("div");div.textContent=msg;
      panel.appendChild(div);panel.scrollTop=panel.scrollHeight;updateStats();}
    function updateStats(){document.getElementById("statsPanel").innerHTML=
      `ğŸ“Š Stats â€” AutoNext:${stats.autoNext} | ManualNext:${stats.manualNext} | Shuffle:${stats.shuffle} | Restart:${stats.restart} | Pauses:${stats.pauses} | VolumeChanges:${stats.volumeChanges}`;}
    function rndInt(min,max){return Math.floor(min+Math.random()*(max-min+1));}
    function rndDelayMs(minS,maxS){return (minS+Math.random()*(maxS-minS))*1000;}

    fetch("https://raw.githubusercontent.com/DeadManWalkingTO/MacrosDmW/refs/heads/main/player/list.txt")
      .then(r=>r.text()).then(text=>{videoList=text.trim().split("\n").filter(Boolean);initPlayers(getRandomVideos(8));});

    function getRandomVideos(n){return [...videoList].sort(()=>Math.random()-0.5).slice(0,n);}
    function initPlayers(videoIds){
      videoIds.forEach((id,i)=>{players[i]=new YT.Player(`player${i+1}`,{videoId:id,events:{onReady:onPlayerReady,onStateChange:onPlayerStateChange}});});
    }

    function onPlayerReady(e){
      const p=e.target; p.mute();
      const startDelay=rndDelayMs(START_DELAY_MIN_S,START_DELAY_MAX_S);
      setTimeout(()=>{
        const seek=rndInt(0,INIT_SEEK_MAX_S);
        p.seekTo(seek,true); p.playVideo(); p.setPlaybackQuality('small');
        log(`[${ts()}] â–¶ Start after ${Math.round(startDelay/1000)}s: id=${p.getVideoData().video_id}, seek=${seek}s`);
        scheduleRandomPauses(p); scheduleMidSeek(p);
      },startDelay);
    }

    function onPlayerStateChange(e){
      if(e.data===YT.PlayerState.ENDED){
        const newId=getRandomVideos(1)[0];
        e.target.loadVideoById(newId); stats.autoNext++;
        log(`[${ts()}] â­ AutoNext: ${newId}`);
        scheduleRandomPauses(e.target); scheduleMidSeek(e.target);
      }
    }

    // Random pauses
    function scheduleRandomPauses(p){
      const delay=rndDelayMs(30,120); // Î¼Î­ÏƒÎ± ÏƒÏ„Î± Ï€ÏÏÏ„Î± 2 Î»ÎµÏ€Ï„Î¬
      setTimeout(()=>{
        const pauseLen=rndInt(PAUSE_SMALL[0],PAUSE_SMALL[1]);
        p.pauseVideo(); stats.pauses++;
        log(`[${ts()}] â¸ Small pause ${pauseLen/1000}s: id=${p.getVideoData().video_id}`);
        setTimeout(()=>{p.playVideo();log(`[${ts()}] â–¶ Resume after small pause`);},pauseLen);
      },delay);
      const delay2=rndDelayMs(120,240);
      setTimeout(()=>{
        const pauseLen=rndInt(PAUSE_LARGE[0],PAUSE_LARGE[1]);
        p.pauseVideo(); stats.pauses++;
        log(`[${ts()}] â¸ Large pause ${pauseLen/1000}s: id=${p.getVideoData().video_id}`);
        setTimeout(()=>{p.playVideo();log(`[${ts()}] â–¶ Resume after large pause`);},pauseLen);
      },delay2);
    }

    // Mid-seek
    function scheduleMidSeek(p){
      const interval=rndInt(MID_SEEK_INTERVAL_MIN[0],MID_SEEK_INTERVAL_MIN[1])*60000;
      setTimeout(()=>{
        const seek=rndInt(MID_SEEK_WINDOW_S[0],MID_SEEK_WINDOW_S[1]);
        p.seekTo(seek,true);
        log(`[${ts()}] â¤´ Mid-seek to ${seek}s: id=${p.getVideoData().video_id}`);
        scheduleMidSeek(p);
      },interval);
    }

    // Controls
    function playAll(){players.forEach(p=>p.playVideo());log(`[${ts()}] â–¶ Play All`);}
    function pauseAll(){players.forEach(p=>p.pauseVideo());stats.pauses++;log(`[${ts()}] â¸ Pause All`
