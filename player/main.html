<!DOCTYPE html>
<html lang="el">
<head>
  <meta charset="utf-8" />
  <title>Main Active Desktop Page</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    :root { --gap: 10px; --grid-height: 60vh; }
    body { margin:0; font-family:system-ui, -apple-system, Segoe UI, Roboto, sans-serif; background:#111; color:#eee; }
    .controls { background:#1a1a1a; padding:12px; text-align:center; position:sticky; top:0; z-index:10; border-bottom:1px solid #333; }
    .controls h1 { margin:0 0 8px; font-size:20px; }
    .controls .row { display:flex; flex-wrap:wrap; gap:8px; justify-content:center; }
    button { background:#222; color:#eee; border:1px solid #444; padding:8px 14px; border-radius:6px; cursor:pointer; }
    button:hover { background:#2b2b2b; border-color:#666; }
    .grid { display:grid; grid-template-columns:repeat(4,1fr); gap:var(--gap); padding:var(--gap); height:var(--grid-height); }
    iframe { width:100%; height:100%; border:none; border-radius:8px; background:#000; }
    @media (max-width:768px) {
      .grid { grid-template-columns:repeat(2,1fr); height:auto; }
      iframe { height:220px; }
    }
    .activity { background:#1a1a1a; border-top:1px solid #333; padding:10px; font-size:13px; height:20vh; overflow-y:auto; }
    .stats { background:#222; padding:8px; font-size:12px; border-top:1px solid #333; }
    /* Light mode */
    body.light { background:#f9f9f9; color:#222; }
    body.light .controls { background:#eaeaea; border-bottom-color:#ccc; }
    body.light button { background:#fff; color:#222; border-color:#ccc; }
    body.light button:hover { background:#ddd; border-color:#999; }
    body.light .activity { background:#eaeaea; border-top-color:#ccc; }
    body.light .stats { background:#ddd; border-top-color:#ccc; }
  </style>
</head>
<body>
  <div class="controls">
    <h1>Main Active Desktop Page</h1>
    <div class="row">
      <button onclick="playAll()">â–¶ Play All</button>
      <button onclick="pauseAll()">â¸ Pause All</button>
      <button onclick="stopAll()">â¹ Stop All</button>
      <button onclick="nextAll()">â­ Next All</button>
      <button onclick="shuffleAll()">ğŸ² Shuffle All</button>
      <button onclick="restartAll()">ğŸ” Restart All</button>
      <button onclick="toggleMuteAll()">ğŸ”‡ Mute/Unmute All</button>
      <button onclick="randomizeVolumeAll()">ğŸ”Š Volume Randomize All</button>
      <button onclick="normalizeVolumeAll()">ğŸš Volume Normalize All</button>
      <button onclick="toggleTheme()">ğŸŒ“ Dark/Light Mode</button>
    </div>
  </div>

  <div class="grid">
    <div id="player1"></div><div id="player2"></div><div id="player3"></div><div id="player4"></div>
    <div id="player5"></div><div id="player6"></div><div id="player7"></div><div id="player8"></div>
  </div>

  <div class="activity" id="activityPanel"></div>
  <div class="stats" id="statsPanel">ğŸ“Š Stats â€” AutoNext:0 | ManualNext:0 | Shuffle:0 | Restart:0 | Pauses:0 | VolumeChanges:0</div>

  <script src="https://www.youtube.com/iframe_api"></script>
  <script>
    // --- State
    let players = [];
    let isMutedAll = true;
    const stats = { autoNext:0, manualNext:0, shuffle:0, restart:0, pauses:0, volumeChanges:0 };

    // --- Video IDs (ÏƒÏ„Î±Î¸ÎµÏÎ® Î»Î¯ÏƒÏ„Î± Î±Ï€ÏŒ ÎµÏƒÎ­Î½Î±)
    const videoList = [
      "ibfVWogZZhU","mYn9JUxxi0M","sWCTs_rQNy8","JFweOaiCoj4","U6VWEuOFRLQ",
      "ARn8J7N1hIQ","3nd2812IDA4","RFO0NWk-WPw","biwbtfnq9JI","3EXSD6DDCrU",
      "WezZYKX7AAY","AhRR2nQ71Eg","xIQBnFvFTfg","ZWbRPcCbZA8","YsdWYiPlEsE"
    ];

    // --- Config
    const START_DELAY_MIN_S = 5, START_DELAY_MAX_S = 180;
    const INIT_SEEK_MAX_S = 60;
    const UNMUTE_VOL_MIN = 10, UNMUTE_VOL_MAX = 30;
    const NORMALIZE_VOLUME_TARGET = 20;
    const PAUSE_SMALL_MS = [2000, 5000];
    const PAUSE_LARGE_MS = [15000, 30000];
    const MID_SEEK_INTERVAL_MIN = [5, 9];
    const MID_SEEK_WINDOW_S = [30, 120];

    // --- Utils
    const ts = () => new Date().toLocaleTimeString();
    function log(msg) {
      console.log(msg);
      const panel = document.getElementById("activityPanel");
      const div = document.createElement("div");
      div.textContent = msg;
      panel.appendChild(div);
      panel.scrollTop = panel.scrollHeight;
      updateStats();
    }
    function updateStats() {
      document.getElementById("statsPanel").textContent =
        `ğŸ“Š Stats â€” AutoNext:${stats.autoNext} | ManualNext:${stats.manualNext} | Shuffle:${stats.shuffle} | Restart:${stats.restart} | Pauses:${stats.pauses} | VolumeChanges:${stats.volumeChanges}`;
    }
    const rndInt = (min, max) => Math.floor(min + Math.random() * (max - min + 1));
    const rndDelayMs = (minS, maxS) => (minS + Math.random() * (maxS - minS)) * 1000;
    function getRandomVideos(n) { return [...videoList].sort(() => Math.random() - 0.5).slice(0, n); }

    // --- YouTube API ready -> init players
    function onYouTubeIframeAPIReady() {
      initPlayers(getRandomVideos(8));
    }

    function initPlayers(videoIds) {
      videoIds.forEach((id, i) => {
        players[i] = new YT.Player(`player${i+1}`, {
          videoId: id,
          events: { onReady: onPlayerReady, onStateChange: onPlayerStateChange }
        });
      });
      log(`[${ts()}] âœ… Players initialized (${videoIds.length})`);
    }

    function onPlayerReady(e) {
      const p = e.target;
      p.mute();

      // Î¤Ï…Ï‡Î±Î¯Î± ÎºÎ±Î¸Ï…ÏƒÏ„Î­ÏÎ·ÏƒÎ· ÎµÎºÎºÎ¯Î½Î·ÏƒÎ·Ï‚ Î±Î½Î¬ player
      const startDelay = rndDelayMs(START_DELAY_MIN_S, START_DELAY_MAX_S);
      setTimeout(() => {
        const seek = rndInt(0, INIT_SEEK_MAX_S);
        p.seekTo(seek, true);
        p.playVideo();
        p.setPlaybackQuality('small');
        log(`[${ts()}] â–¶ Start after ${Math.round(startDelay/1000)}s: id=${p.getVideoData().video_id}, seek=${seek}s`);

        // Î¦Ï…ÏƒÎ¹ÎºÎ­Ï‚ ÏƒÏ…Î¼Ï€ÎµÏÎ¹Ï†Î¿ÏÎ­Ï‚
        scheduleRandomPauses(p);
        scheduleMidSeek(p);
      }, startDelay);
    }

    function onPlayerStateChange(e) {
      if (e.data === YT.PlayerState.ENDED) {
        const p = e.target;
        const newId = getRandomVideos(1)[0];
        p.loadVideoById(newId);
        stats.autoNext++;
        log(`[${ts()}] â­ AutoNext: ${newId}`);
        // Î•Ï€Î±Î½Î±Ï€ÏÎ¿Î³ÏÎ±Î¼Î¼Î±Ï„Î¹ÏƒÎ¼ÏŒÏ‚ ÏƒÏ…Î¼Ï€ÎµÏÎ¹Ï†Î¿ÏÏÎ½ Î³Î¹Î± Ï„Î¿ Î½Î­Î¿ Î²Î¯Î½Ï„ÎµÎ¿
        scheduleRandomPauses(p);
        scheduleMidSeek(p);
      }
    }

    // --- Natural behaviors
    function scheduleRandomPauses(p) {
      // ÎœÎ¹ÎºÏÎ® Ï€Î±ÏÏƒÎ· Î½Ï‰ÏÎ¯Ï‚
      const delaySmall = rndDelayMs(30, 120);
      setTimeout(() => {
        const pauseLen = rndInt(PAUSE_SMALL_MS[0], PAUSE_SMALL_MS[1]);
        p.pauseVideo(); stats.pauses++;
        log(`[${ts()}] â¸ Small pause ${Math.round(pauseLen/1000)}s: id=${p.getVideoData().video_id}`);
        setTimeout(() => { p.playVideo(); log(`[${ts()}] â–¶ Resume after small pause`); }, pauseLen);
      }, delaySmall);

      // ÎœÎµÎ³Î¬Î»Î· Ï€Î±ÏÏƒÎ· Î±ÏÎ³ÏŒÏ„ÎµÏÎ±
      const delayLarge = rndDelayMs(120, 240);
      setTimeout(() => {
        const pauseLen = rndInt(PAUSE_LARGE_MS[0], PAUSE_LARGE_MS[1]);
        p.pauseVideo(); stats.pauses++;
        log(`[${ts()}] â¸ Large pause ${Math.round(pauseLen/1000)}s: id=${p.getVideoData().video_id}`);
        setTimeout(() => { p.playVideo(); log(`[${ts()}] â–¶ Resume after large pause`); }, pauseLen);
      }, delayLarge);
    }

    function scheduleMidSeek(p) {
      const interval = rndInt(MID_SEEK_INTERVAL_MIN[0], MID_SEEK_INTERVAL_MIN[1]) * 60000;
      setTimeout(() => {
        const seek = rndInt(MID_SEEK_WINDOW_S[0], MID_SEEK_WINDOW_S[1]);
        p.seekTo(seek, true);
        log(`[${ts()}] â¤´ Mid-seek to ${seek}s: id=${p.getVideoData().video_id}`);
        // Î•Ï€Î±Î½Î±Î»Î·Ï€Ï„Î¹ÎºÎ¬ mid-seeks
        scheduleMidSeek(p);
      }, interval);
    }

    // --- Controls
    function playAll() { players.forEach(p => p.playVideo()); log(`[${ts()}] â–¶ Play All`); }
    function pauseAll() { players.forEach(p => p.pauseVideo()); stats.pauses++; log(`[${ts()}] â¸ Pause All`); }
    function stopAll() { players.forEach(p => p.stopVideo()); log(`[${ts()}] â¹ Stop All`); }

    function nextAll() {
      players.forEach(p => { const newId = getRandomVideos(1)[0]; p.loadVideoById(newId); p.playVideo(); });
      stats.manualNext++; log(`[${ts()}] â­ Next All`);
    }

    function shuffleAll() {
      const sh = getRandomVideos(players.length);
      players.forEach((p, i) => { p.loadVideoById(sh[i]); p.playVideo(); });
      stats.shuffle++; log(`[${ts()}] ğŸ² Shuffle All`);
    }

    function restartAll() {
      const set = getRandomVideos(players.length);
      players.forEach((p, i) => { p.stopVideo(); p.loadVideoById(set[i]); p.playVideo(); });
      stats.restart++; log(`[${ts()}] ğŸ” Restart All`);
    }

    // Mute/Unmute Ï‰Ï‚ Enable Sound Î¼Îµ Ï„Ï…Ï‡Î±Î¯Î± Î­Î½Ï„Î±ÏƒÎ·
    function toggleMuteAll() {
      if (isMutedAll) {
        players.forEach((p, i) => {
          p.unMute();
          const v = rndInt(UNMUTE_VOL_MIN, UNMUTE_VOL_MAX); // 10â€“30%
          p.setVolume(v);
          log(`[${ts()}] ğŸ”Š Enable Sound + Unmute: Player${i+1} -> ${v}%`);
        });
      } else {
        players.forEach((p, i) => { p.mute(); log(`[${ts()}] ğŸ”‡ Mute: Player${i+1}`); });
      }
      isMutedAll = !isMutedAll;
    }

    function randomizeVolumeAll() {
      players.forEach((p, i) => { const v = rndInt(0, 100); p.setVolume(v); });
      stats.volumeChanges++; log(`[${ts()}] ğŸ”Š Randomize Volume All`);
    }

    function normalizeVolumeAll() {
      players.forEach((p, i) => { p.setVolume(NORMALIZE_VOLUME_TARGET); });
      stats.volumeChanges++; log(`[${ts()}] ğŸš Normalize Volume All`);
    }

    function toggleTheme() {
      document.body.classList.toggle("light");
      log(`[${ts()}] ğŸŒ“ Theme toggled`);
    }
  </script>
</body>
</html>
